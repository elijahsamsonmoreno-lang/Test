<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEIM | Economic Impact Analysis</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@500;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        :root {
            --bg-base: #09090b; --bg-elevated: #18181b; --bg-surface: #27272a; --border: #3f3f46; --border-subtle: #27272a;
            --text-primary: #fafafa; --text-secondary: #a1a1aa; --text-muted: #71717a;
            --accent: #22d3ee; --accent-dim: rgba(34,211,238,0.15);
            --success: #4ade80; --success-dim: rgba(74,222,128,0.15);
            --warning: #fbbf24; --warning-dim: rgba(251,191,36,0.15);
            --rose: #fb7185; --rose-dim: rgba(251,113,133,0.15);
            --radius-sm: 6px; --radius-md: 10px; --radius-lg: 14px;
        }
        html { font-size: 14px; }
        body { font-family: 'Inter', -apple-system, sans-serif; background: var(--bg-base); color: var(--text-primary); line-height: 1.5; min-height: 100vh; -webkit-font-smoothing: antialiased; }
        .app { display: flex; min-height: 100vh; }
        .sidebar { width: 260px; background: var(--bg-elevated); border-right: 1px solid var(--border-subtle); display: flex; flex-direction: column; position: fixed; height: 100vh; z-index: 100; }
        .sidebar-brand { padding: 24px; border-bottom: 1px solid var(--border-subtle); }
        .brand-logo { display: flex; align-items: center; gap: 12px; }
        .brand-mark { width: 40px; height: 40px; background: linear-gradient(135deg, var(--accent), #06b6d4); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 16px; color: var(--bg-base); }
        .brand-name { font-size: 20px; font-weight: 700; letter-spacing: -0.02em; }
        .brand-tag { font-size: 11px; color: var(--text-muted); margin-top: 2px; }
        .sidebar-nav { padding: 16px 12px; flex: 1; }
        .nav-section { margin-bottom: 24px; }
        .nav-label { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-muted); padding: 0 12px; margin-bottom: 8px; }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 10px 12px; border-radius: var(--radius-md); color: var(--text-secondary); font-size: 13px; font-weight: 500; cursor: pointer; transition: all 0.15s ease; }
        .nav-item:hover { background: var(--bg-surface); color: var(--text-primary); }
        .nav-item.active { background: var(--accent-dim); color: var(--accent); }
        .nav-item svg { width: 18px; height: 18px; opacity: 0.7; }
        .nav-item.active svg { opacity: 1; }
        .main { flex: 1; margin-left: 260px; display: flex; flex-direction: column; }
        .header { padding: 16px 32px; background: var(--bg-elevated); border-bottom: 1px solid var(--border-subtle); display: flex; align-items: center; justify-content: space-between; position: sticky; top: 0; z-index: 50; }
        .header-title h1 { font-size: 18px; font-weight: 600; }
        .header-title p { font-size: 12px; color: var(--text-muted); margin-top: 2px; }
        .header-actions { display: flex; gap: 10px; }
        .btn { display: inline-flex; align-items: center; gap: 8px; padding: 9px 16px; border-radius: var(--radius-md); font-size: 13px; font-weight: 600; font-family: inherit; cursor: pointer; transition: all 0.15s ease; border: 1px solid transparent; }
        .btn svg { width: 16px; height: 16px; }
        .btn-ghost { background: transparent; color: var(--text-secondary); border-color: var(--border); }
        .btn-ghost:hover { background: var(--bg-surface); color: var(--text-primary); }
        .btn-primary { background: var(--accent); color: var(--bg-base); }
        .btn-primary:hover { background: #67e8f9; }
        .btn.loading { opacity: 0.6; pointer-events: none; }
        .content { padding: 32px; flex: 1; }
        .dashboard-grid { display: grid; grid-template-columns: 340px 1fr; gap: 24px; }
        .card { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); }
        .card-header { padding: 16px 20px; border-bottom: 1px solid var(--border-subtle); display: flex; align-items: center; justify-content: space-between; }
        .card-title { font-size: 14px; font-weight: 600; }
        .card-badge { font-size: 10px; font-weight: 600; padding: 4px 10px; border-radius: 100px; background: var(--accent-dim); color: var(--accent); }
        .card-body { padding: 20px; }
        .form-section { margin-bottom: 24px; padding-bottom: 24px; border-bottom: 1px solid var(--border-subtle); }
        .form-section:last-child { margin-bottom: 0; padding-bottom: 0; border-bottom: none; }
        .form-section-title { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.08em; color: var(--text-muted); margin-bottom: 16px; }
        .form-group { margin-bottom: 16px; }
        .form-group:last-child { margin-bottom: 0; }
        .form-label { display: block; font-size: 12px; font-weight: 500; color: var(--text-secondary); margin-bottom: 6px; }
        .form-input { width: 100%; padding: 10px 12px; background: var(--bg-surface); border: 1px solid var(--border); border-radius: var(--radius-sm); font-size: 13px; font-family: inherit; color: var(--text-primary); transition: all 0.15s ease; }
        .form-input:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px var(--accent-dim); }
        select.form-input { cursor: pointer; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 10px center; padding-right: 36px; }
        .slider-header { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 10px; }
        .slider-value { font-family: 'JetBrains Mono', monospace; font-size: 15px; font-weight: 600; color: var(--accent); }
        .slider-track { position: relative; height: 6px; background: var(--bg-surface); border-radius: 3px; overflow: hidden; }
        .slider-fill { position: absolute; height: 100%; background: linear-gradient(90deg, var(--accent), #06b6d4); border-radius: 3px; transition: width 0.1s ease; }
        input[type="range"] { width: 100%; height: 20px; -webkit-appearance: none; background: transparent; cursor: pointer; margin-top: -13px; position: relative; z-index: 2; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; background: var(--text-primary); border-radius: 50%; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.4); }
        .slider-scale { display: flex; justify-content: space-between; margin-top: 6px; font-size: 10px; color: var(--text-muted); font-family: 'JetBrains Mono', monospace; }
        .form-hint { font-size: 11px; color: var(--text-muted); margin-top: 6px; }
        .results-panel { display: flex; flex-direction: column; gap: 24px; }
        .metrics-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; }
        .metric-card { background: var(--bg-elevated); border: 1px solid var(--border-subtle); border-radius: var(--radius-lg); padding: 20px; transition: all 0.2s ease; }
        .metric-card:hover { border-color: var(--border); transform: translateY(-2px); }
        .metric-icon { width: 40px; height: 40px; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; margin-bottom: 14px; }
        .metric-icon svg { width: 20px; height: 20px; }
        .metric-icon.cyan { background: var(--accent-dim); color: var(--accent); }
        .metric-icon.green { background: var(--success-dim); color: var(--success); }
        .metric-icon.amber { background: var(--warning-dim); color: var(--warning); }
        .metric-icon.rose { background: var(--rose-dim); color: var(--rose); }
        .metric-value { font-family: 'JetBrains Mono', monospace; font-size: 26px; font-weight: 600; margin-bottom: 4px; }
        .metric-label { font-size: 12px; color: var(--text-muted); }
        .charts-row { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
        .chart-area { height: 240px; display: flex; align-items: center; justify-content: center; }
        .donut-chart { position: relative; width: 200px; height: 200px; }
        .donut-chart svg { transform: rotate(-90deg); }
        .donut-center { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
        .donut-center-value { font-family: 'JetBrains Mono', monospace; font-size: 22px; font-weight: 600; }
        .donut-center-label { font-size: 11px; color: var(--text-muted); }
        .chart-legend { display: flex; justify-content: center; gap: 20px; margin-top: 16px; }
        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 12px; color: var(--text-secondary); }
        .legend-dot { width: 10px; height: 10px; border-radius: 3px; }
        .bar-chart { width: 100%; height: 200px; display: flex; align-items: flex-end; justify-content: space-around; padding: 0 20px; gap: 24px; }
        .bar-group { display: flex; flex-direction: column; align-items: center; flex: 1; }
        .bar-container { display: flex; gap: 6px; align-items: flex-end; height: 160px; }
        .bar { width: 28px; border-radius: 4px 4px 0 0; transition: height 0.3s ease; }
        .bar.output { background: linear-gradient(180deg, var(--accent), #0891b2); }
        .bar.jobs { background: linear-gradient(180deg, var(--success), #16a34a); }
        .bar-label { font-size: 11px; color: var(--text-muted); margin-top: 10px; }
        .data-table { width: 100%; border-collapse: collapse; }
        .data-table th { text-align: left; padding: 12px 16px; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.08em; color: var(--text-muted); background: var(--bg-surface); border-bottom: 1px solid var(--border-subtle); }
        .data-table th:last-child, .data-table td:last-child { text-align: right; }
        .data-table td { padding: 14px 16px; font-size: 13px; border-bottom: 1px solid var(--border-subtle); font-family: 'JetBrains Mono', monospace; }
        .data-table td:first-child { font-family: 'Inter', sans-serif; }
        .data-table tbody tr:hover td { background: var(--bg-surface); }
        .data-table .total-row td { font-weight: 600; background: var(--bg-surface); border-top: 2px solid var(--border); }
        .effect-indicator { display: flex; align-items: center; gap: 10px; }
        .effect-dot { width: 8px; height: 8px; border-radius: 2px; }
        .effect-dot.direct { background: var(--accent); }
        .effect-dot.indirect { background: var(--success); }
        .effect-dot.induced { background: var(--warning); }
        .method-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
        .method-item { padding: 16px; background: var(--bg-surface); border-radius: var(--radius-md); border-left: 3px solid var(--accent); }
        .method-item h4 { font-size: 13px; font-weight: 600; margin-bottom: 6px; }
        .method-item p { font-size: 12px; color: var(--text-muted); line-height: 1.6; }
        .footer { padding: 12px 32px; background: var(--bg-elevated); border-top: 1px solid var(--border-subtle); display: flex; justify-content: space-between; font-size: 11px; color: var(--text-muted); }
        .status-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--success); display: inline-block; margin-right: 6px; }
        @media (max-width: 1200px) { .dashboard-grid { grid-template-columns: 1fr; } .metrics-row { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 900px) { .sidebar { display: none; } .main { margin-left: 0; } .charts-row, .method-grid { grid-template-columns: 1fr; } }
        @media (max-width: 600px) { .metrics-row { grid-template-columns: 1fr; } .content { padding: 16px; } }
    </style>
</head>
<body>
    <div class="app">
        <aside class="sidebar">
            <div class="sidebar-brand"><div class="brand-logo"><div class="brand-mark">T</div><div><div class="brand-name">TEIM</div><div class="brand-tag">Tribal Economic Impact Model</div></div></div></div>
            <nav class="sidebar-nav">
                <div class="nav-section"><div class="nav-label">Analysis</div>
                    <div class="nav-item active"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>Impact Dashboard</div>
                    <div class="nav-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>Scenarios</div>
                    <div class="nav-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg>Reports</div>
                </div>
                <div class="nav-section"><div class="nav-label">Configuration</div>
                    <div class="nav-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>SAM Structure</div>
                    <div class="nav-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="10" r="3"/><path d="M12 21.7C17.3 17 20 13 20 10a8 8 0 1 0-16 0c0 3 2.7 7 8 11.7z"/></svg>Regions</div>
                </div>
            </nav>
        </aside>
        <main class="main">
            <header class="header">
                <div class="header-title"><h1>Economic Impact Analysis</h1><p>Type SAM multipliers with Leontief inverse calculations</p></div>
                <div class="header-actions">
                    <button class="btn btn-ghost" onclick="resetDefaults()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>Reset</button>
                    <button class="btn btn-primary" id="downloadBtn" onclick="generatePDF()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>Export PDF</button>
                </div>
            </header>
            <div class="content">
                <div class="dashboard-grid">
                    <div class="input-panel">
                        <div class="card">
                            <div class="card-header"><span class="card-title">Model Inputs</span><span class="card-badge">Interactive</span></div>
                            <div class="card-body">
                                <div class="form-section">
                                    <div class="form-section-title">Project Definition</div>
                                    <div class="form-group"><label class="form-label">Enterprise Name</label><input type="text" class="form-input" id="enterpriseName" value="Tribal Gaming Enterprise"></div>
                                    <div class="form-group"><label class="form-label">Analysis Region</label><select class="form-input" id="region"><option value="reservation">Reservation</option><option value="state" selected>State</option></select><div class="form-hint">Geographic scope affects RPC and leakage</div></div>
                                </div>
                                <div class="form-section">
                                    <div class="form-section-title">Direct Effects</div>
                                    <div class="form-group">
                                        <div class="slider-header"><label class="form-label">Direct Employment (FTE)</label><span class="slider-value" id="employmentValue">500</span></div>
                                        <div class="slider-track"><div class="slider-fill" id="employmentFill" style="width:25%"></div></div>
                                        <input type="range" id="employment" min="0" max="2000" value="500">
                                        <div class="slider-scale"><span>0</span><span>500</span><span>1,000</span><span>1,500</span><span>2,000</span></div>
                                    </div>
                                    <div class="form-group"><label class="form-label">Average Annual Compensation ($)</label><input type="number" class="form-input" id="avgWage" value="45000" min="20000" max="150000" step="1000"><div class="form-hint">Employee Compensation: wages + benefits</div></div>
                                </div>
                                <div class="form-section">
                                    <div class="form-section-title">Model Parameters</div>
                                    <div class="form-group">
                                        <div class="slider-header"><label class="form-label">Type SAM Multiplier</label><span class="slider-value" id="multiplierValue">1.80x</span></div>
                                        <div class="slider-track"><div class="slider-fill" id="multiplierFill" style="width:40%"></div></div>
                                        <input type="range" id="multiplier" min="100" max="300" value="180">
                                        <div class="slider-scale"><span>1.0x</span><span>1.5x</span><span>2.0x</span><span>2.5x</span><span>3.0x</span></div>
                                        <div class="form-hint">Direct + Indirect + Induced effects</div>
                                    </div>
                                    <div class="form-group">
                                        <div class="slider-header"><label class="form-label">Economic Leakage</label><span class="slider-value" id="leakageValue">25%</span></div>
                                        <div class="slider-track"><div class="slider-fill" id="leakageFill" style="width:30%"></div></div>
                                        <input type="range" id="leakage" min="10" max="60" value="25">
                                        <div class="slider-scale"><span>10%</span><span>25%</span><span>40%</span><span>55%</span></div>
                                        <div class="form-hint">Imports, taxes, savings, commuter outflows</div>
                                    </div>
                                </div>
                                <button class="btn btn-primary" style="width:100%;" onclick="recalculate()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>Run Model</button>
                            </div>
                        </div>
                    </div>
                    <div class="results-panel">
                        <div class="metrics-row">
                            <div class="metric-card"><div class="metric-icon cyan"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div><div class="metric-value" id="totalOutput">$30.4M</div><div class="metric-label">Total Economic Output</div></div>
                            <div class="metric-card"><div class="metric-icon green"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></div><div class="metric-value" id="totalJobs">675</div><div class="metric-label">Total Jobs Supported</div></div>
                            <div class="metric-card"><div class="metric-icon amber"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="4" width="22" height="16" rx="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg></div><div class="metric-value" id="totalWages">$19.7M</div><div class="metric-label">Total Labor Income</div></div>
                            <div class="metric-card"><div class="metric-icon rose"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg></div><div class="metric-value" id="effectiveMultiplier">1.35x</div><div class="metric-label">Effective Multiplier</div></div>
                        </div>
                        <div class="charts-row">
                            <div class="card"><div class="card-header"><span class="card-title">Impact Distribution</span></div>
                                <div class="card-body"><div class="chart-area">
                                    <div class="donut-chart"><svg width="200" height="200" viewBox="0 0 200 200"><circle cx="100" cy="100" r="70" fill="none" stroke="var(--bg-surface)" stroke-width="24"/><circle id="donutDirect" cx="100" cy="100" r="70" fill="none" stroke="var(--accent)" stroke-width="24" stroke-dasharray="0 440"/><circle id="donutIndirect" cx="100" cy="100" r="70" fill="none" stroke="var(--success)" stroke-width="24" stroke-dasharray="0 440"/><circle id="donutInduced" cx="100" cy="100" r="70" fill="none" stroke="var(--warning)" stroke-width="24" stroke-dasharray="0 440"/></svg><div class="donut-center"><div class="donut-center-value" id="donutTotal">$30.4M</div><div class="donut-center-label">Total Output</div></div></div>
                                </div><div class="chart-legend"><div class="legend-item"><div class="legend-dot" style="background:var(--accent)"></div>Direct</div><div class="legend-item"><div class="legend-dot" style="background:var(--success)"></div>Indirect</div><div class="legend-item"><div class="legend-dot" style="background:var(--warning)"></div>Induced</div></div></div>
                            </div>
                            <div class="card"><div class="card-header"><span class="card-title">Scenario Comparison</span></div>
                                <div class="card-body"><div class="chart-area">
                                    <div class="bar-chart">
                                        <div class="bar-group"><div class="bar-container"><div class="bar output" id="bar1Output" style="height:100px"></div><div class="bar jobs" id="bar1Jobs" style="height:100px"></div></div><div class="bar-label">Current</div></div>
                                        <div class="bar-group"><div class="bar-container"><div class="bar output" id="bar2Output" style="height:85px"></div><div class="bar jobs" id="bar2Jobs" style="height:85px"></div></div><div class="bar-label">Conservative</div></div>
                                        <div class="bar-group"><div class="bar-container"><div class="bar output" id="bar3Output" style="height:130px"></div><div class="bar jobs" id="bar3Jobs" style="height:130px"></div></div><div class="bar-label">Growth</div></div>
                                        <div class="bar-group"><div class="bar-container"><div class="bar output" id="bar4Output" style="height:155px"></div><div class="bar jobs" id="bar4Jobs" style="height:155px"></div></div><div class="bar-label">Expansion</div></div>
                                    </div>
                                </div><div class="chart-legend"><div class="legend-item"><div class="legend-dot" style="background:var(--accent)"></div>Output ($M)</div><div class="legend-item"><div class="legend-dot" style="background:var(--success)"></div>Jobs</div></div></div>
                            </div>
                        </div>
                        <div class="card"><div class="card-header"><span class="card-title">Impact Breakdown</span><span class="card-badge">Leontief Decomposition</span></div>
                            <table class="data-table"><thead><tr><th>Effect Type</th><th>Employment</th><th>Labor Income</th><th>Value Added</th><th>Output</th><th>Share</th></tr></thead>
                            <tbody>
                                <tr><td><span class="effect-indicator"><span class="effect-dot direct"></span>Direct</span></td><td id="tblDirectJobs">500</td><td id="tblDirectWages">$22.5M</td><td id="tblDirectVA">$18.0M</td><td id="tblDirectOutput">$22.5M</td><td id="tblDirectShare">74.0%</td></tr>
                                <tr><td><span class="effect-indicator"><span class="effect-dot indirect"></span>Indirect</span></td><td id="tblIndirectJobs">105</td><td id="tblIndirectWages">$4.7M</td><td id="tblIndirectVA">$3.8M</td><td id="tblIndirectOutput">$4.7M</td><td id="tblIndirectShare">15.6%</td></tr>
                                <tr><td><span class="effect-indicator"><span class="effect-dot induced"></span>Induced</span></td><td id="tblInducedJobs">70</td><td id="tblInducedWages">$3.2M</td><td id="tblInducedVA">$2.5M</td><td id="tblInducedOutput">$3.2M</td><td id="tblInducedShare">10.4%</td></tr>
                                <tr class="total-row"><td>Total Impact</td><td id="tblTotalJobs">675</td><td id="tblTotalWages">$30.4M</td><td id="tblTotalVA">$24.3M</td><td id="tblTotalOutput">$30.4M</td><td>100.0%</td></tr>
                            </tbody></table>
                        </div>
                        <div class="card"><div class="card-header"><span class="card-title">Methodology</span><span class="card-badge">TEIM Framework</span></div>
                            <div class="card-body"><div class="method-grid">
                                <div class="method-item"><h4>Direct Effects</h4><p>Initial industry output from enterprise operations. Direct Output = Employment × Average Compensation.</p></div>
                                <div class="method-item"><h4>Indirect Effects</h4><p>Supply chain impacts via Leontief inverse (I−A)⁻¹. Calculated as Direct × (Multiplier−1) × 0.6 adjusted for leakage.</p></div>
                                <div class="method-item"><h4>Induced Effects</h4><p>Household respending of labor income. Calculated as Direct × (Multiplier−1) × 0.4 adjusted for leakage.</p></div>
                            </div></div>
                        </div>
                    </div>
                </div>
            </div>
            <footer class="footer"><div><span class="status-dot"></span>Model ready • Updated <span id="timestamp">--</span></div><div>TEIM v0.1 • Indian Country Development</div></footer>
        </main>
    </div>
    <script>
        function calculateImpacts() {
            const employment = parseInt(document.getElementById('employment').value);
            const avgWage = parseInt(document.getElementById('avgWage').value);
            const multiplier = parseInt(document.getElementById('multiplier').value) / 100;
            const leakage = parseInt(document.getElementById('leakage').value) / 100;
            const directOutput = (employment * avgWage) / 1000000;
            const directJobs = employment;
            const effectiveMultiplier = 1 + (multiplier - 1) * (1 - leakage);
            const totalOutput = directOutput * effectiveMultiplier;
            const additionalOutput = totalOutput - directOutput;
            const indirectOutput = additionalOutput * 0.6;
            const inducedOutput = additionalOutput * 0.4;
            const indirectJobs = Math.round(indirectOutput * 1000000 / 90000);
            const inducedJobs = Math.round(inducedOutput * 1000000 / 75000);
            const totalJobs = directJobs + indirectJobs + inducedJobs;
            const vaRatio = 0.80, laborRatio = 0.65;
            const directVA = directOutput * vaRatio, indirectVA = indirectOutput * vaRatio, inducedVA = inducedOutput * vaRatio, totalVA = totalOutput * vaRatio;
            const directWages = directOutput * laborRatio, indirectWages = indirectOutput * laborRatio, inducedWages = inducedOutput * laborRatio, totalWages = totalOutput * laborRatio;
            return { direct: { output: directOutput, jobs: directJobs, wages: directWages, va: directVA }, indirect: { output: indirectOutput, jobs: indirectJobs, wages: indirectWages, va: indirectVA }, induced: { output: inducedOutput, jobs: inducedJobs, wages: inducedWages, va: inducedVA }, total: { output: totalOutput, jobs: totalJobs, wages: totalWages, va: totalVA }, effectiveMultiplier };
        }
        function updateUI(r) {
            document.getElementById('totalOutput').textContent = '$' + r.total.output.toFixed(1) + 'M';
            document.getElementById('totalJobs').textContent = r.total.jobs.toLocaleString();
            document.getElementById('totalWages').textContent = '$' + r.total.wages.toFixed(1) + 'M';
            document.getElementById('effectiveMultiplier').textContent = r.effectiveMultiplier.toFixed(2) + 'x';
            ['Direct','Indirect','Induced'].forEach(t => {
                const k = t.toLowerCase();
                document.getElementById('tbl'+t+'Jobs').textContent = r[k].jobs.toLocaleString();
                document.getElementById('tbl'+t+'Wages').textContent = '$' + r[k].wages.toFixed(1) + 'M';
                document.getElementById('tbl'+t+'VA').textContent = '$' + r[k].va.toFixed(1) + 'M';
                document.getElementById('tbl'+t+'Output').textContent = '$' + r[k].output.toFixed(1) + 'M';
                document.getElementById('tbl'+t+'Share').textContent = ((r[k].output / r.total.output) * 100).toFixed(1) + '%';
            });
            document.getElementById('tblTotalJobs').textContent = r.total.jobs.toLocaleString();
            document.getElementById('tblTotalWages').textContent = '$' + r.total.wages.toFixed(1) + 'M';
            document.getElementById('tblTotalVA').textContent = '$' + r.total.va.toFixed(1) + 'M';
            document.getElementById('tblTotalOutput').textContent = '$' + r.total.output.toFixed(1) + 'M';
            const c = 2 * Math.PI * 70;
            const dp = r.direct.output / r.total.output, ip = r.indirect.output / r.total.output, up = r.induced.output / r.total.output;
            const dl = dp * c, il = ip * c, ul = up * c;
            document.getElementById('donutDirect').setAttribute('stroke-dasharray', dl + ' ' + c);
            document.getElementById('donutDirect').setAttribute('stroke-dashoffset', '0');
            document.getElementById('donutIndirect').setAttribute('stroke-dasharray', il + ' ' + c);
            document.getElementById('donutIndirect').setAttribute('stroke-dashoffset', -dl);
            document.getElementById('donutInduced').setAttribute('stroke-dasharray', ul + ' ' + c);
            document.getElementById('donutInduced').setAttribute('stroke-dashoffset', -(dl + il));
            document.getElementById('donutTotal').textContent = '$' + r.total.output.toFixed(1) + 'M';
            const mh = 150, sc = [1, 0.85, 1.3, 1.7];
            sc.forEach((f, i) => {
                const oh = Math.min(mh, (r.total.output * f / (r.total.output * 1.8)) * mh);
                const jh = Math.min(mh, (r.total.jobs * f / (r.total.jobs * 1.8)) * mh);
                document.getElementById('bar'+(i+1)+'Output').style.height = oh + 'px';
                document.getElementById('bar'+(i+1)+'Jobs').style.height = jh + 'px';
            });
            document.getElementById('timestamp').textContent = new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
        }
        function updateSlider(id) {
            const s = document.getElementById(id), v = parseFloat(s.value), mn = parseFloat(s.min), mx = parseFloat(s.max);
            document.getElementById(id + 'Fill').style.width = ((v - mn) / (mx - mn)) * 100 + '%';
            if (id === 'employment') document.getElementById('employmentValue').textContent = parseInt(v).toLocaleString();
            else if (id === 'multiplier') document.getElementById('multiplierValue').textContent = (v / 100).toFixed(2) + 'x';
            else if (id === 'leakage') document.getElementById('leakageValue').textContent = v + '%';
        }
        function recalculate() { updateUI(calculateImpacts()); }
        function resetDefaults() {
            document.getElementById('enterpriseName').value = 'Tribal Gaming Enterprise';
            document.getElementById('region').value = 'state';
            document.getElementById('employment').value = 500;
            document.getElementById('avgWage').value = 45000;
            document.getElementById('multiplier').value = 180;
            document.getElementById('leakage').value = 25;
            ['employment', 'multiplier', 'leakage'].forEach(updateSlider);
            recalculate();
        }
        async function generatePDF() {
            const btn = document.getElementById('downloadBtn');
            btn.classList.add('loading');
            btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg> Generating...';
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pw = pdf.internal.pageSize.getWidth(), ph = pdf.internal.pageSize.getHeight(), m = 20, cw = pw - 2 * m;
                const r = calculateImpacts();
                const name = document.getElementById('enterpriseName').value;
                const region = document.getElementById('region').options[document.getElementById('region').selectedIndex].text;
                const employment = parseInt(document.getElementById('employment').value);
                const avgWage = parseInt(document.getElementById('avgWage').value);
                const multiplier = parseInt(document.getElementById('multiplier').value) / 100;
                const leakage = parseInt(document.getElementById('leakage').value);
                pdf.setFillColor(9, 9, 11); pdf.rect(0, 0, pw, 45, 'F');
                pdf.setFillColor(34, 211, 238); pdf.roundedRect(m, 12, 10, 10, 2, 2, 'F');
                pdf.setFontSize(14); pdf.setTextColor(9, 9, 11); pdf.setFont('helvetica', 'bold'); pdf.text('T', m + 3, 19.5);
                pdf.setTextColor(250, 250, 250); pdf.setFontSize(18); pdf.text('TEIM', m + 16, 19);
                pdf.setFontSize(9); pdf.setFont('helvetica', 'normal'); pdf.setTextColor(161, 161, 170); pdf.text('Tribal Economic Impact Model', m + 16, 26);
                pdf.setFontSize(10); pdf.setTextColor(250, 250, 250); pdf.text('Economic Impact Report', pw - m, 18, { align: 'right' });
                pdf.setFontSize(9); pdf.setTextColor(161, 161, 170); pdf.text(new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }), pw - m, 26, { align: 'right' });
                let y = 58;
                pdf.setTextColor(39, 39, 42); pdf.setFontSize(16); pdf.setFont('helvetica', 'bold'); pdf.text(name, m, y);
                y += 7; pdf.setFontSize(10); pdf.setFont('helvetica', 'normal'); pdf.setTextColor(113, 113, 122); pdf.text('Analysis Region: ' + region + ' • Type SAM Multipliers', m, y);
                y += 15; pdf.setFillColor(244, 244, 245); pdf.roundedRect(m, y, cw, 48, 3, 3, 'F');
                pdf.setFontSize(9); pdf.setFont('helvetica', 'bold'); pdf.setTextColor(113, 113, 122); pdf.text('SUMMARY RESULTS', m + 8, y + 10);
                const metrics = [{ label: 'Total Output', value: '$' + r.total.output.toFixed(1) + 'M', color: [6, 182, 212] }, { label: 'Jobs Supported', value: r.total.jobs.toLocaleString(), color: [74, 222, 128] }, { label: 'Labor Income', value: '$' + r.total.wages.toFixed(1) + 'M', color: [251, 191, 36] }, { label: 'Eff. Multiplier', value: r.effectiveMultiplier.toFixed(2) + 'x', color: [251, 113, 133] }];
                const mw = (cw - 40) / 4;
                metrics.forEach((met, i) => { const x = m + 8 + i * (mw + 10); pdf.setTextColor(...met.color); pdf.setFontSize(18); pdf.setFont('helvetica', 'bold'); pdf.text(met.value, x, y + 28); pdf.setTextColor(113, 113, 122); pdf.setFontSize(9); pdf.setFont('helvetica', 'normal'); pdf.text(met.label, x, y + 36); });
                y += 60; pdf.setTextColor(39, 39, 42); pdf.setFontSize(12); pdf.setFont('helvetica', 'bold'); pdf.text('Model Inputs', m, y);
                y += 8; const inputs = [['Analysis Region', region], ['Direct Employment', employment.toLocaleString() + ' FTE'], ['Average Compensation', '$' + avgWage.toLocaleString()], ['Type SAM Multiplier', multiplier.toFixed(2) + 'x'], ['Economic Leakage', leakage + '%']];
                pdf.setFontSize(9); inputs.forEach((row, i) => { const ry = y + i * 8; if (i % 2 === 0) { pdf.setFillColor(250, 250, 250); pdf.rect(m, ry - 3, cw, 8, 'F'); } pdf.setTextColor(82, 82, 91); pdf.setFont('helvetica', 'normal'); pdf.text(row[0], m + 4, ry + 2); pdf.setTextColor(39, 39, 42); pdf.setFont('helvetica', 'bold'); pdf.text(row[1], pw - m - 4, ry + 2, { align: 'right' }); });
                y += 55; pdf.setTextColor(39, 39, 42); pdf.setFontSize(12); pdf.setFont('helvetica', 'bold'); pdf.text('Impact Breakdown', m, y);
                y += 8; pdf.setFillColor(39, 39, 42); pdf.rect(m, y - 3, cw, 9, 'F'); pdf.setTextColor(250, 250, 250); pdf.setFontSize(8); pdf.setFont('helvetica', 'bold');
                const cols = [35, 28, 30, 30, 28, 22]; const headers = ['Effect Type', 'Employment', 'Labor Income', 'Value Added', 'Output', 'Share'];
                let tx = m + 4; headers.forEach((h, i) => { pdf.text(h, tx, y + 3); tx += cols[i]; });
                y += 9; pdf.setFont('helvetica', 'normal'); pdf.setFontSize(9);
                const tableData = [{ name: 'Direct', data: r.direct, color: [34, 211, 238] }, { name: 'Indirect', data: r.indirect, color: [74, 222, 128] }, { name: 'Induced', data: r.induced, color: [251, 191, 36] }];
                tableData.forEach((row, i) => { const ry = y + i * 9; if (i % 2 === 0) { pdf.setFillColor(250, 250, 250); pdf.rect(m, ry - 3, cw, 9, 'F'); } pdf.setFillColor(...row.color); pdf.circle(m + 6, ry + 1, 2, 'F'); pdf.setTextColor(39, 39, 42); tx = m + 12; pdf.text(row.name, tx, ry + 2); tx = m + 4 + cols[0]; pdf.text(row.data.jobs.toLocaleString(), tx, ry + 2); tx += cols[1]; pdf.text('$' + row.data.wages.toFixed(1) + 'M', tx, ry + 2); tx += cols[2]; pdf.text('$' + row.data.va.toFixed(1) + 'M', tx, ry + 2); tx += cols[3]; pdf.text('$' + row.data.output.toFixed(1) + 'M', tx, ry + 2); tx += cols[4]; pdf.text(((row.data.output / r.total.output) * 100).toFixed(1) + '%', tx, ry + 2); });
                y += 27; pdf.setFillColor(229, 231, 235); pdf.rect(m, y - 3, cw, 9, 'F'); pdf.setFont('helvetica', 'bold'); pdf.setTextColor(39, 39, 42);
                tx = m + 4; const totals = ['Total Impact', r.total.jobs.toLocaleString(), '$' + r.total.wages.toFixed(1) + 'M', '$' + r.total.va.toFixed(1) + 'M', '$' + r.total.output.toFixed(1) + 'M', '100.0%'];
                totals.forEach((t, i) => { pdf.text(t, tx, y + 2); tx += cols[i]; });
                y += 20; pdf.setFontSize(12); pdf.setFont('helvetica', 'bold'); pdf.text('Methodology', m, y);
                y += 8; pdf.setFontSize(8); pdf.setFont('helvetica', 'normal'); pdf.setTextColor(82, 82, 91);
                const methodText = 'This analysis uses input-output modeling with Type SAM multipliers. Direct effects = Employment x Compensation. Effective Multiplier = 1 + (SAM Multiplier - 1) x (1 - Leakage). Indirect effects (60% of additional impact) capture supply chain purchases via Leontief inverse. Induced effects (40%) represent household respending. Value Added = 80% of output; Labor Income = 65% of output.';
                pdf.text(pdf.splitTextToSize(methodText, cw), m, y);
                pdf.setFillColor(250, 250, 250); pdf.rect(0, ph - 14, pw, 14, 'F'); pdf.setDrawColor(229, 231, 235); pdf.line(0, ph - 14, pw, ph - 14);
                pdf.setFontSize(8); pdf.setTextColor(161, 161, 170); pdf.text('TEIM | Tribal Economic Impact Model | Indian Country Development', m, ph - 5); pdf.text('Page 1', pw - m, ph - 5, { align: 'right' });
                pdf.save(name.replace(/[^a-z0-9]/gi, '_').substring(0, 30) + '_TEIM_Report.pdf');
            } catch (err) { console.error(err); alert('Error generating PDF'); }
            btn.classList.remove('loading');
            btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg> Export PDF';
        }
        document.addEventListener('DOMContentLoaded', function() {
            ['employment', 'multiplier', 'leakage'].forEach(id => { document.getElementById(id).addEventListener('input', function() { updateSlider(id); recalculate(); }); });
            document.getElementById('avgWage').addEventListener('change', recalculate);
            document.getElementById('region').addEventListener('change', recalculate);
            recalculate();
        });
    </script>
</body>
</html>
